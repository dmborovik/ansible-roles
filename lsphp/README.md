LSPHP Deployment
================

Этот проект предоставляет Ansible роль для установки и настройки LSPHP (LiteSpeed PHP). Роль также поддерживает установку дополнительных модулей PHP и управление репозиториями (EPEL и LiteSpeed).

Описание
--------

Роль **LSPHP** автоматизирует установку и настройку LSPHP. Основные функции:

- Установка LSPHP указанной версии.
- Установка дополнительных модулей PHP (например, `mysql`, `gd`, `curl`).
- Добавление репозиториев EPEL и LiteSpeed (если они отсутствуют).
- Настройка символической ссылки для LSPHP.

Роли поддерживают следующие операционные системы:

- **AlmaLinux**: `8`|`9`
- **Ubuntu**: `24`

Требования
----------

- **Ansible:** Версия 2.9 или выше.
- **Целевые системы:** см. описание выше.
- **Доступ:** Убедитесь, что у вас есть доступ к целевым системам по SSH с правами sudo.

Роли
----

Основные задачи:

1. **Установка EPEL:**

    - Проверяет наличие репозитория EPEL и устанавливает его, если он отсутствует.

2. **Установка репозитория LiteSpeed:**

    - Проверяет наличие репозитория LiteSpeed и добавляет его, если он отсутствует.

3. **Установка LSPHP:**

    - Устанавливает LSPHP указанной версии.

4. **Установка модулей LSPHP:**

    - Устанавливает дополнительные модули PHP (например, `mysql`, `gd`, `curl`).

5. **Настройка символической ссылки:**

    - Создает символическую ссылку для LSPHP.

Использование
-------------

1. Создайте файл инвентаря (`inventory.ini`) с указанием целевых хостов:

    ```ini
    [webservers]
    server1 ansible_host=192.168.1.10
    server2 ansible_host=192.168.1.11
    ```
  
2. Создайте плейбук (например, `site.yml`):

    ```yaml
    ---
    - hosts: webservers
      become: yes
      roles:
        - lsphp
    ```

3. Запустите плейбук:

    ```bash
    ansible-playbook -i inventory.ini site.yml
    ```

Переменные
----------

Основные переменные:

- `lsphp_version`: Версия LSPHP (по умолчанию: `83`).
- `lsphp_modules`: Список дополнительных модулей PHP (например, `mysql`, `gd`, `curl`).

Пример переменных в `defaults/main.yml`:

```yaml
lsphp_version: 83
lsphp_modules:
  - mysql
  - gd
  - curl
```

Примеры
-------

Установка LSPHP с пользовательскими параметрами

```yaml
- hosts: webservers
  become: yes
  vars:
    lsphp_version: 83
    lsphp_modules:
      - mysql
      - gd
      - curl
  roles:
    - lsphp
```

Установка только LSPHP без модулей

```yaml
- hosts: webservers
  become: yes
  roles:
    - lsphp
```

Использование в качестве роли в других плэйбуках:

```yaml
    - hosts: servers
      roles:
        - { role: lsphp, lsphp_version: 83, lsphp_modules: "{{ php_module }}" }
```
