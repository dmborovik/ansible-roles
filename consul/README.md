# Ansible Role: Consul

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ HashiCorp Consul –≤ —Ä–µ–∂–∏–º–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–∞.

## üì¶ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –û–°:
  - AlmaLinux `8`|`9`
- Ansible >= 2.10

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ Consul
- –†–∞–±–æ—Ç–∞ –∫–∞–∫ —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∫–æ–Ω—Ñ–∏–≥ –∏ systemd unit
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ HTTP API
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ tag-–æ–≤ –¥–ª—è –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞—á

---

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è              | –û–ø–∏—Å–∞–Ω–∏–µ                                   | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é     |
|-------------------------|--------------------------------------------|----------------------------|
| `datacenter`            | –ù–∞–∑–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Ü–µ–Ω—Ç—Ä–∞                        | `dev`                      |
| `consul_version`        | –í–µ—Ä—Å–∏—è Consul                              | `"1.15.4"`                 |
| `consul_user`           | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Consul            | `"consul"`                 |
| `consul_group`          | –ì—Ä—É–ø–ø–∞ –¥–ª—è Consul                          | `"consul"`                 |
| `consul_config_dir`     | –ü—É—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏            | `"/etc/consul.d"`          |
| `consul_data_dir`       | –ü—É—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö                  | `"/opt/consul"`            |
| `consul_bind_address`   | –ê–¥—Ä–µ—Å, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –±–∏–Ω–¥–∏–º—Å—è                 | `"0.0.0.0"`                |
| `consul_client_address` | –ê–¥—Ä–µ—Å, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–Ω–∏–º–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã        | `"127.0.0.1"`              |
| `consul_node_role`      | –†–æ–ª—å –Ω–æ–¥—ã (`server` –∏–ª–∏ `client`)          | `"server"`                 |
| `consul_command_args`   | –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞ (–±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ systemd unit) | `agent -config-dir=...` |

---

## üì¶ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```yaml
- hosts: consul_servers
  become: yes
  roles:
    - role: consul
      vars:
        datacenter: "prod"
        consul_version: "1.15.4"
        consul_node_role: "server"
